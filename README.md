# LLM-Powered Game Development

A Unity-based game that leverages a local LLM (e.g., LLAMA) for NPC decision-making and dialogue, using a TCP communication layer between Unity (C#) and Python.

---

## Table of Contents

1. [Features](#features)
2. [Current Progress](#current-progress)
3. [To-Do](#to-do)
4. [Future Improvements](#future-improvements)
5. [Security Considerations](#security-considerations)
6. [Setup](#setup)
7. [Notes & Pitfalls](#notes--pitfalls)

---

## Features

- **Persistent TCP Connections**: Reuse the same client connections for multiple requests.
- **LLM-Driven NPC Dialogue**: NPC conversations are generated by the LLM.
- **Custom Game Mechanics**: Collision physics and movement systems built from scratch.
- **Dynamic NPC Generation**: Easily add new NPCs via scripting.
- **Debug HTTP API (FastAPI)**: Alternative debugging interface (higher overhead).

---

## Current Progress

- ✅ Reliable connection management with delays and retry logic.
- ✅ TCP server implementation for Python ↔ Unity communication.
- ✅ NPC dialog integration with the LLM.
- ✅ Ports cleanly closed on application shutdown.
- ✅ Dynamic component injection for NPC prefabs.
- ✅ Custom movement and collision physics groundwork.

---

## To-Do

1. **Chunkify Data**
   - Split large payloads into configurable-size chunks instead of fixed 1024 bytes.

2. **Graceful Connection Handling**
   - Avoid forcefully killing terminal connections.
   - Evaluate overhead of opening/closing vs. persistent sockets.
   - Consider storing client address globally and closing all on shutdown.

3. **Secure TCP Layer**
   - Add authentication (e.g., token-based handshake).
   - Encrypt payloads (TLS or custom crypto).

4. **Protocol Refinement**
   - Standardize request/response formats for LLM ↔ NPC communications.
   - Document message types and error codes.

5. **Connection Reliability**
   - Investigate startup race conditions causing first-connect failures.
   - Ensure `sys.path` and dependencies fully loaded before listening.

---

## Future Improvements

- Maintain active connections in a managed loop to avoid garbage collection.
- Auto-parse larger-than-buffer payloads reliably.
- Abstract connection setup inside request functions if client addresses must refresh per request.
- Improve FastAPI debug server while balancing throughput vs. overhead.

---

## Security Considerations

- Ports exposed over local network are potential vulnerabilities.
- Forceful termination of sockets may lead to resource leaks.
- Conda environment quirks can break socket handling; prefer minimal environments.

---

## Setup

1. **Clone Repository**:
   ```bash
   git clone <repo-url>
   cd <repo-folder>
